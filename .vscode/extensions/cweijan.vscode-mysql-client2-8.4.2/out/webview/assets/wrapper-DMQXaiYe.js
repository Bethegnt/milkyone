import{D as s,e as i,a as l}from"./DatabaseType-BbdbLm9P.js";import{a as S,c,d as A}from"./viewUtil-CTdDvppq.js";function B(e){return e==null?!0:typeof e=="string"?["","NULL","undefined"].includes(e.toUpperCase()):!1}function o(e,r){if(u(e)&&typeof r=="string"){if(/boolean/i.test(e)){if(/^true$/i.test(r))return!0;if(/^false$/i.test(r))return!1}const n=/float|double|decimal/i.test(e)||r.includes(".")?parseFloat(r):parseInt(r);if(n!=null&&!isNaN(n))return n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER?r:n}return null}function E(e){return typeof e!="string"?e:e.replace(/ /g," ")}function U(e){return typeof e!="string"?e:e.replace(/(^'|'$)/g,"")}class T{isSupport(r){return S(r)}convert(r,t,n){if(t.startsWith("0x")){const a=t.slice(2);switch(n){case s.PG:return`'\\x${a}'`;case s.REDSHIFT:return`from_hex('${a}')`;case s.libSQL:case s.SQLITE:case s.DUCK_DB:return`x'${a}'`;case s.SNOWFLAKE:return`TO_BINARY('${a}', 'hex')`}return t}else switch(n){case s.DB2:return`CAST('${t}' AS BLOB)`;case s.SQLServer:return`CAST('${t}' AS varbinary)`;case s.DM:case s.ORACLE:return`rawtohex('${t}')`;case s.CASSANDRA:return`textAsBlob('${t}')`}}}class m{isSupport(r){return r.match(/DATE/i)!=null}convert(r,t,n){switch(n){case s.TRINO:return`from_iso8601_timestamp('${t}')`;case s.ORACLE:return`TO_DATE('${t}','yyyy/mm/dd hh24:mi:ss')`}}}class p{isSupport(r,t,n){return n==s.ORACLE&&r.match(/TIMESTAMP/i)!=null}convert(r,t,n){return`TO_TIMESTAMP('${t}','yyyy/mm/dd hh24:mi:ss')`}}class N{isSupport(r,t,n){return[s.ES,s.MONGO_DB].includes(n)}convert(r,t,n){return o(r,t)??t}}class C{isSupport(r,t,n){return!0}convert(r,t,n){typeof t=="string"&&(t=t.replace(/'/g,"''"));const a=`'${t}'`;return i(n)?a.replace(/\\/g,"\\\\"):a}}class R{isSupport(r,t,n){return u(r)}convert(r,t,n){return o(r,t)}}class D{isSupport(r,t,n){return/bit/i.test(r)}convert(r,t,n){return i(n)?`b'${t}'`:l(n)?`B'${t}'`:n==s.SQLServer&&typeof t=="string"&&t?.match(/true|false/i)?`'${t}'`:t}}class b{isSupport(r,t,n){return/^(bool|boolean)$/i.test(r)&&/true|false/i.test(t)}convert(r,t,n){return t}}class y{isSupport(r){return!0}convert(r,t,n){switch(n){case s.CASSANDRA:if(r?.match(/uuid/i))return t;break;case s.PG:case s.REDSHIFT:if(t.includes("nextval("))return t;break;case s.SQLServer:if(c(r))return`N'${t.replace(/'/g,"''")}'`;break;case s.TRINO:if(r?.match(/json/i))return`json_parse('${t.replace(/'/g,"''").replace(/ /g," ").replace(/\\/g,"\\\\")}')`;break}}}class _{isSupport(r,t,n){return i(n)&&A(r)}convert(r,t,n){if(t.match(/\w+\(/))return`ST_GeomFromText('${t}')`}}const I=[new N,new D,new R,new b,new T,new m,new p,new _,new y,new C];function L(e,r,t){e||(e=""),r=`${r}`;for(const n of I)if(n.isSupport(e,r,t)){const a=n.convert(e,r,t);if(a!=null)return a}}const $=new Set(["ACCOUNT","ACTION","ALL","ANY","BACKUP","BEGIN","CHARACTER","CONDITION","CURRENT","DATA","DATE","DESC","EXPLAIN","FROM","GRANT","GROUP","GROUPS","INDEX","JOIN","KEY","LENGTH","ORDER","PRIMARY","REGEXP","SIGNAL","SOURCE","SYSTEM","TABLE","TYPE","UNION","USER","VALUE","DATABASE","SCHEMA","VIEW","PROCEDURE","FUNCTION","TRIGGER","EVENT","SEQUENCE","COLUMN","DEFAULT","SET","TEMPORARY","OPEN"]);var w=(e=>(e.True="true",e.False="false",e.Never="never",e.Always="always",e.Auto="auto",e))(w||{});function f(e){return e?.includes(".")?e.split(".").map(r=>f(r)).join("."):e?.replace(/^[`"\[](.+?)[`"\]]$/,"$1")}function M(e,r,t=!0){if(e==null||["MongoDB"].includes(r)||t=="never"||(t==!0&&(t="always"),t==!1&&(t="auto"),r==s.JDBC&&t=="auto"))return e;const n=e.match(/[A-Z]/g)&&![s.SNOWFLAKE,s.ORACLE,s.DM,s.DB2,s.AS400,s.EXASOL].includes(r),a=/[~!@#$%^&*()/\s\|,.<>?"'();:+\-=\[\]{}]|^[0-9]/;return t=="always"||n||e.match(a)||$.has(e.toUpperCase())?(e=f(e),[s.MYSQL,s.MARIA_DB,s.DORIS,s.NEO4J,s.BIG_QUERY,s.DATABRICKS,s.TDengine].includes(r)?`\`${e}\``:`"${e}"`):e}function F(e,r,t){if(r==null||r===""&&!c(e))return"null";typeof r=="object"&&r?.origin&&(r=r.origin),r=E(r);const n=L(e,r,t);if(n!=null)return n}function G(e,r){return u(r)?e:`'${e}'`}function u(e){if(!e||typeof e=="number"||e.includes("[]")||e=="interval")return!1;const r=["int","number","numeric","serial","float","double","decimal","real","bool","boolean"];return!e.match(/point/i)&&e.match(new RegExp(r.join("|"),"i"))!=null}export{w as E,U as a,M as b,B as c,G as g,u as i,o as s,E as t,F as w};
